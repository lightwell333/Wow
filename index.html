<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"/>
<title>Ultra Green DJ Decks ‚Äî Appear/Hide + Dual Waveforms + Record</title>
<style>
  :root{
    --bg:#050807; --panel:#0a1110; --line:#0f1a18;
    --fg:#eafff4; --muted:#9fd0c0; --glow:#35ff9a; --glow2:#7bffc8; --danger:#ff4d6d; --accent:#1cff88;
  }
  html,body{height:100%;margin:0;background:linear-gradient(180deg,#000,#020805 60%, #00110b);color:var(--fg);font-family:ui-sans-serif,system-ui,Segoe UI,Roboto,Helvetica,Arial}
  *{-webkit-user-select:none; user-select:none; -webkit-touch-callout:none}
  body{touch-action:manipulation}

  /* ===== Floating APPEAR button (left edge, 3/4 down) ===== */
  .edge-left{
    position:fixed; left:10px; top:75vh; transform:translateY(-50%); z-index:9999;
    padding:12px 16px; border-radius:14px; cursor:pointer;
    background:#07120e; color:#eafff4; border:1px solid #0f261e;
    box-shadow:0 0 12px var(--glow), 0 0 24px var(--glow2);
    text-shadow:0 0 6px var(--glow), 0 0 12px var(--glow2);
  }
  .edge-left:hover{ box-shadow:0 0 18px var(--glow), 0 0 36px var(--glow2) }
  .edge-left.pulse{ animation: gpulse 1.4s ease-in-out infinite }
  @keyframes gpulse{
    0%,100%{ box-shadow:0 0 12px var(--glow), 0 0 24px var(--glow2) }
    50%    { box-shadow:0 0 18px var(--glow), 0 0 40px var(--glow2) }
  }

  /* ===== App wrapper ===== */
  .wrap{max-width:min(1200px,98vw); margin:18px auto; padding:12px;}
  .panel{background:linear-gradient(180deg,#07100d,#091613); border:1px solid var(--line); border-radius:14px; padding:12px; box-shadow:0 0 0 1px #0a1714, 0 0 25px rgba(53,255,154,.12)}
  .row{display:flex; gap:12px; align-items:center; flex-wrap:wrap}
  .col{display:flex; flex-direction:column; gap:10px}
  .muted{color:var(--muted); font-size:12px}
  .h{font-weight:700; letter-spacing:.3px}
  .glowTxt{ text-shadow:0 0 8px var(--glow), 0 0 18px var(--glow2) }

  .btn{
    border:1px solid #0f261e; background:#07120e; color:var(--fg);
    padding:10px 14px; border-radius:12px; cursor:pointer;
    box-shadow:0 0 0 1px #0a1714, 0 0 18px rgba(28,255,136,.15) inset;
    transition:transform .05s ease, box-shadow .2s ease;
  }
  .btn:hover{ box-shadow:0 0 0 1px #0a1714, 0 0 22px rgba(28,255,136,.28) inset }
  .btn:active{ transform:translateY(1px) }
  .btn.hot{ background:radial-gradient(100% 100% at 50% 0%, #0e2a1f, #0a1714); color:#eafff4; border-color:#124f3b }
  .btn.rec{ background:#1a0b0e; border-color:#2b0f16; box-shadow:0 0 12px rgba(255,77,109,.35) inset, 0 0 24px rgba(255,77,109,.18) }

  input[type=range], input[type=file]{
    appearance:none; -webkit-appearance:none;
    background:#07120e; color:var(--fg); border:1px solid #103127; border-radius:10px; padding:8px 10px;
    box-shadow:0 0 0 1px #0a1714 inset, 0 0 16px rgba(53,255,154,.12) inset; font-size:14px;
  }
  input[type=range]{ height:28px; width:200px }
  input[type=range]::-webkit-slider-thumb{ -webkit-appearance:none; width:18px;height:18px;border-radius:10px; background:var(--glow);
    box-shadow:0 0 8px var(--glow), 0 0 18px var(--glow2) }
  input[type=range]::-moz-range-thumb{ width:18px;height:18px;border:none;border-radius:10px;background:var(--glow); box-shadow:0 0 8px var(--glow), 0 0 18px var(--glow2)}

  .tag{font-size:12px; padding:6px 8px; border:1px solid #0f261e; border-radius:10px; background:#07120e; color:var(--muted)}

  .decks{display:grid; grid-template-columns: 1fr 1fr; gap:14px}
  .deck{display:grid; grid-template-rows:auto auto auto; gap:10px}
  .wavebox{position:relative; background:#05100c; border:1px solid #0e241d; border-radius:12px; padding:8px}
  canvas.wave{ width:100%; height:140px; display:block; border-radius:8px; background:linear-gradient(180deg,#04110c,#071a14 60%, #03100b); box-shadow:inset 0 0 25px rgba(53,255,154,.08)}
  .playhead{ position:absolute; top:8px; bottom:8px; width:2px; left:20%; background:var(--accent); box-shadow:0 0 10px var(--accent) }

  .xfade{display:flex; gap:12px; align-items:center; justify-content:center}
  .xfade>input[type=range]{ width: min(560px, 90vw) }

  .meters{display:flex; gap:8px; align-items:center}
  .meter{width:8px; height:42px; background:#0b1714; border:1px solid #103127; border-radius:4px; position:relative; overflow:hidden}
  .meter>.fill{position:absolute; bottom:0; left:0; width:100%; height:30%; background:linear-gradient(180deg,var(--glow2),var(--glow)); box-shadow:0 0 12px var(--glow) }

  /* Show/Hide animation for the whole panel */
  #decks-panel{ transition: opacity .25s ease, transform .25s ease; will-change:opacity,transform }
  #decks-panel[hidden]{ opacity:0; transform: translateX(-8px); pointer-events:none }

  /* Top bar hide button alignment */
  .bar-top{display:flex; justify-content:space-between; align-items:center; gap:12px}
</style>
</head>
<body>

<!-- ===== LEFT-EDGE APPEAR BUTTON ===== -->
<button id="btn-appear" class="edge-left">‚ñ≤ Appear</button>

<!-- ===== MAIN PANEL (hidden at load) ===== -->
<div id="decks-panel" hidden>
  <div class="wrap" id="ultraWrap">

    <!-- TOP BAR with HIDE + file/vol controls + meters -->
    <div class="panel bar-top">
      <button id="btn-hide" class="btn">‚úñ Hide</button>

      <div class="row">
        <button id="playA" class="btn hot">‚ñ∂ Deck A</button>
        <button id="pauseA" class="btn">‚ùö‚ùö</button>
        <label class="tag">A Vol <input id="volA" type="range" min="0" max="1.5" step="0.01" value="1"></label>
        <label class="tag">Load A <input id="fileA" type="file" accept="audio/*"></label>
      </div>

      <div class="row">
        <label class="tag">Master <input id="masterVol" type="range" min="0" max="1.5" step="0.01" value="1"></label>
        <div class="meters">
          <div class="meter"><div id="mA" class="fill" style="height:10%"></div></div>
          <div class="meter"><div id="mB" class="fill" style="height:10%"></div></div>
        </div>
      </div>

      <div class="row">
        <label class="tag">Load B <input id="fileB" type="file" accept="audio/*"></label>
        <label class="tag">B Vol <input id="volB" type="range" min="0" max="1.5" step="0.01" value="1"></label>
        <button id="pauseB" class="btn">‚ùö‚ùö</button>
        <button id="playB" class="btn hot">‚ñ∂ Deck B</button>
      </div>
    </div>

    <!-- WAVEFORMS -->
    <div class="decks">
      <div class="panel deck" id="deckA">
        <div class="h glowTxt">Deck A</div>
        <div class="wavebox">
          <canvas id="waveA" class="wave"></canvas>
          <div id="headA" class="playhead"></div>
        </div>
        <div class="row">
          <button id="cueSetA" class="btn">Set Cue</button>
          <button id="cueGoA" class="btn">Cue ‚ñ∂</button>
          <label class="tag">Seek A <input id="seekA" type="range" min="0" max="1" step="0.001" value="0"></label>
        </div>
      </div>

      <div class="panel deck" id="deckB">
        <div class="h glowTxt">Deck B</div>
        <div class="wavebox">
          <canvas id="waveB" class="wave"></canvas>
          <div id="headB" class="playhead"></div>
        </div>
        <div class="row">
          <button id="cueSetB" class="btn">Set Cue</button>
          <button id="cueGoB" class="btn">Cue ‚ñ∂</button>
          <label class="tag">Seek B <input id="seekB" type="range" min="0" max="1" step="0.001" value="0"></label>
        </div>
      </div>
    </div>

    <!-- MIXER -->
    <div class="panel xfade">
      <span class="muted">A</span>
      <input id="xfade" type="range" min="0" max="1" step="0.001" value="0">
      <span class="muted">B</span>
    </div>

    <!-- RECORDER -->
    <div class="panel" style="display:flex; gap:10px; align-items:center; justify-content:flex-end">
      <button id="recBtn" class="btn rec">‚óè Record</button>
      <span id="recLamp" class="lamp" style="width:14px;height:14px;border-radius:999px;background:#193b30; box-shadow:0 0 0 2px #0b1a14 inset"></span>
      <button id="dlBtn" class="btn" disabled>Download Mix</button>
      <span class="muted">Format: audio/webm</span>
    </div>

    <p class="muted">Tip: Click/drag on the waveform to seek. Crossfader is equal-power. Everything glows green üå±</p>
  </div>
</div>

<script>
/* ===== Block copy bar / context menu ===== */
addEventListener('contextmenu', e=> e.preventDefault(), {passive:false});
addEventListener('selectstart', e=> e.preventDefault(), {passive:false});
addEventListener('gesturestart', e=> e.preventDefault(), {passive:false});

/* ===== Appear / Hide wiring ===== */
const panel = document.getElementById('decks-panel');
const appearBtn = document.getElementById('btn-appear');
const hideBtn = document.getElementById('btn-hide');

appearBtn.addEventListener('click', ()=>{
  panel.hidden = false;
  appearBtn.classList.remove('pulse');
});
hideBtn.addEventListener('click', ()=>{
  panel.hidden = true;
  appearBtn.classList.add('pulse');
});

/* ===== Audio Graph ===== */
let ctx, master, recDest, mediaRec, chunks=[], isRec=false;

// per-deck structures
function makeDeck(){
  return {
    fileEl:null, playBtn:null, pauseBtn:null, volEl:null, seekEl:null,
    waveCan:null, waveCtx:null, headEl:null, meterFill:null,
    buffer:null, src:null, gain:null, xGain:null, analyser:null,
    isPlaying:false, startTime:0, offset:0, cue:0
  };
}
const deckA = makeDeck();
const deckB = makeDeck();

function initAudio(){
  if (ctx) return;
  ctx = new (window.AudioContext||window.webkitAudioContext)();

  // Master chain
  master = ctx.createGain(); master.gain.value = parseFloat(document.getElementById('masterVol').value||1);

  // For recording
  recDest = ctx.createMediaStreamDestination();
  master.connect(recDest);
  master.connect(ctx.destination);

  // Deck nodes
  [deckA, deckB].forEach(d=>{
    d.gain = ctx.createGain(); d.gain.gain.value = 1.0;
    d.xGain = ctx.createGain(); d.xGain.gain.value = 1.0;
    d.analyser = ctx.createAnalyser(); d.analyser.fftSize = 2048;
    d.gain.connect(d.xGain).connect(d.analyser).connect(master);
  });

  // initialize crossfader to current
  applyCrossfade(parseFloat(document.getElementById('xfade').value||0));
}

/* ===== File Loading ===== */
function loadFileToDeck(file, deck){
  if (!file) return;
  initAudio();
  const reader = new FileReader();
  reader.onload = async (e)=>{
    const array = e.target.result;
    try{
      const buffer = await ctx.decodeAudioData(array);
      deck.buffer = buffer;
      deck.offset = 0;
      deck.cue = 0;
      deck.seekEl.value = 0;
      drawWave(deck);
      stopDeck(deck);
      prepareSource(deck);
    }catch(err){
      console.error('Decode error:', err);
      alert('Could not decode that audio file.');
    }
  };
  reader.readAsArrayBuffer(file);
}

/* ===== Source handling / transport ===== */
function prepareSource(deck){
  if(!deck.buffer) return;
  if(deck.src){ try{ deck.src.disconnect(); }catch{} deck.src = null; }
  const src = ctx.createBufferSource();
  src.buffer = deck.buffer;
  src.connect(deck.gain);
  deck.src = src;
}
function playDeck(deck){
  if(!deck.buffer) return;
  initAudio();
  if(deck.isPlaying) return;
  prepareSource(deck);
  deck.startTime = ctx.currentTime - deck.offset;
  deck.src.start(0, deck.offset);
  deck.isPlaying = true;
  deck.src.onended = ()=>{
    if(deck.isPlaying){
      deck.isPlaying = false;
      deck.offset = 0;
      deck.seekEl.value = 0;
      prepareSource(deck);
    }
  }
}
function pauseDeck(deck){
  if(!deck.isPlaying) return;
  try{ deck.src.stop(); }catch{}
  deck.offset = Math.min(deck.buffer.duration, Math.max(0, ctx.currentTime - deck.startTime));
  deck.isPlaying = false;
  prepareSource(deck);
}
function stopDeck(deck){
  if(deck.isPlaying){ try{ deck.src.stop(); }catch{} }
  deck.isPlaying = false;
  deck.offset = 0;
  deck.seekEl.value = 0;
  prepareSource(deck);
}

/* ===== Seeking & Cue ===== */
function setSeek(deck, norm){
  if(!deck.buffer) return;
  const pos = norm * deck.buffer.duration;
  const was = deck.isPlaying;
  if(was) pauseDeck(deck);
  deck.offset = pos;
  deck.seekEl.value = norm;
  if(was) playDeck(deck);
  drawHeads();
}
function setCue(deck){ if(deck.buffer) deck.cue = deck.offset; }
function goCue(deck){
  if(!deck.buffer) return;
  const was = deck.isPlaying;
  if(was) pauseDeck(deck);
  deck.offset = Math.min(deck.buffer.duration, Math.max(0, deck.cue));
  deck.seekEl.value = deck.offset / deck.buffer.duration;
  if(was) playDeck(deck);
}

/* ===== Crossfader (equal-power) ===== */
function applyCrossfade(x){
  const gA = Math.cos(0.5*Math.PI*x);
  const gB = Math.cos(0.5*Math.PI*(1-x));
  deckA.xGain.gain.value = gA*gA;
  deckB.xGain.gain.value = gB*gB;
}

/* ===== Meters (simple RMS) ===== */
function analyserLevel(an){
  const arr = new Uint8Array(an.frequencyBinCount);
  an.getByteTimeDomainData(arr);
  let sum=0;
  for(let i=0;i<arr.length;i++){ const v=(arr[i]-128)/128; sum+=v*v; }
  const rms = Math.sqrt(sum/arr.length);
  return Math.min(1, rms*1.8);
}

/* ===== Waveform Drawing ===== */
function drawWave(deck){
  const cvs = deck.waveCan, c = deck.waveCtx;
  const W = cvs.width = Math.floor(cvs.clientWidth * devicePixelRatio);
  const H = cvs.height = Math.floor(cvs.clientHeight * devicePixelRatio);
  c.clearRect(0,0,W,H);

  if(!deck.buffer){
    c.fillStyle = 'rgba(28,255,136,0.06)'; c.fillRect(0,0,W,H); return;
  }
  const ch = deck.buffer.getChannelData(0);
  const samples = W;
  const block = Math.floor(ch.length / samples) || 1;

  c.lineWidth = Math.max(1, Math.floor(1.2 * devicePixelRatio));
  c.strokeStyle = '#35ff9a'; c.shadowColor = '#35ff9a'; c.shadowBlur = 10;

  c.beginPath();
  for(let x=0; x<samples; x++){
    let start = x*block, end = Math.min(ch.length, start+block);
    let min= 1e9, max=-1e9;
    for(let i=start;i<end;i++){ const v = ch[i]; if(v<min) min=v; if(v>max) max=v; }
    const y1 = (1-min)*0.5*H;
    const y2 = (1-max)*0.5*H;
    c.moveTo(x, y1); c.lineTo(x, y2);
  }
  c.stroke();

  c.shadowBlur = 0; c.strokeStyle = 'rgba(124,255,200,.18)';
  c.beginPath(); c.moveTo(0, H/2); c.lineTo(W, H/2); c.stroke();
}
function drawHeads(){
  [[deckA,'headA'], [deckB,'headB']].forEach(([d, idHead])=>{
    const head = d.headEl, wave = d.waveCan;
    if (d.buffer){
      const dur = d.buffer.duration;
      const off = d.isPlaying ? (ctx.currentTime - d.startTime) : d.offset;
      const norm = Math.min(1, Math.max(0, off / dur));
      const px = 8 + norm * (wave.clientWidth - 16);
      head.style.left = px + 'px';
    } else head.style.left = '8px';
  });
}

/* ===== UI Wiring ===== */
function $(id){ return document.getElementById(id); }
function bindDeck(deck, ids){
  deck.playBtn = $(ids.play);
  deck.pauseBtn= $(ids.pause);
  deck.fileEl  = $(ids.file);
  deck.volEl   = $(ids.vol);
  deck.seekEl  = $(ids.seek);
  deck.waveCan = $(ids.wave);
  deck.waveCtx = deck.waveCan.getContext('2d');
  deck.headEl  = $(ids.head);
  deck.meterFill = $(ids.meter);

  deck.fileEl.addEventListener('change', e=> loadFileToDeck(e.target.files[0], deck));
  deck.playBtn.addEventListener('click', ()=> playDeck(deck));
  deck.pauseBtn.addEventListener('click', ()=> pauseDeck(deck));
  deck.volEl.addEventListener('input', ()=> { initAudio(); deck.gain.gain.value = parseFloat(deck.volEl.value||1); });
  deck.seekEl.addEventListener('input', ()=> setSeek(deck, parseFloat(deck.seekEl.value)));

  // Waveform drag-seek
  let dragging=false;
  function normFromEvent(ev){
    const rect = deck.waveCan.getBoundingClientRect();
    const x = (ev.touches? ev.touches[0].clientX : ev.clientX) - rect.left;
    return Math.min(1, Math.max(0, x/rect.width));
    }
  deck.waveCan.addEventListener('pointerdown', (e)=>{ dragging=true; setSeek(deck, normFromEvent(e)); deck.waveCan.setPointerCapture(e.pointerId); });
  deck.waveCan.addEventListener('pointermove', (e)=>{ if(dragging) setSeek(deck, normFromEvent(e)); });
  deck.waveCan.addEventListener('pointerup',   (e)=>{ dragging=false; try{deck.waveCan.releasePointerCapture(e.pointerId);}catch{} });
  deck.waveCan.addEventListener('pointerleave',(e)=>{ dragging=false; });

  new ResizeObserver(()=> drawWave(deck)).observe(deck.waveCan);
}
// Bind decks
bindDeck(deckA, { play:'playA', pause:'pauseA', file:'fileA', vol:'volA', seek:'seekA', wave:'waveA', head:'headA', meter:'mA' });
bindDeck(deckB, { play:'playB', pause:'pauseB', file:'fileB', vol:'volB', seek:'seekB', wave:'waveB', head:'headB', meter:'mB' });

// Cue buttons
$('cueSetA').addEventListener('click', ()=> setCue(deckA));
$('cueGoA').addEventListener('click',  ()=> goCue(deckA));
$('cueSetB').addEventListener('click', ()=> setCue(deckB));
$('cueGoB').addEventListener('click',  ()=> goCue(deckB));

// Crossfader & Master
$('xfade').addEventListener('input', e=> applyCrossfade(parseFloat(e.target.value)));
$('masterVol').addEventListener('input', e=> { initAudio(); master.gain.value = parseFloat(e.target.value||1); });

/* ===== Recording master mix ===== */
const recBtn = $('recBtn'), dlBtn = $('dlBtn'), recLamp = $('recLamp');
recBtn.addEventListener('click', ()=>{
  initAudio();
  if(!mediaRec){
    const stream = recDest.stream;
    try{ mediaRec = new MediaRecorder(stream, {mimeType:'audio/webm'}); }
    catch(e){ mediaRec = new MediaRecorder(stream); }
    mediaRec.ondataavailable = e=> { if(e.data?.size) chunks.push(e.data); };
    mediaRec.onstop = ()=>{
      const blob = new Blob(chunks, {type: chunks[0]?.type || 'audio/webm'});
      chunks = [];
      const url = URL.createObjectURL(blob);
      dlBtn.disabled = false;
      dlBtn._url = url;
    };
  }
  if(!isRec){
    chunks=[]; mediaRec.start(150); isRec=true; recLamp.style.background='#ff445f'; recLamp.style.boxShadow='0 0 10px #ff445f, 0 0 22px rgba(255,68,95,.55)'; recBtn.textContent='‚ñ† Stop';
  }else{
    mediaRec.stop(); isRec=false; recLamp.style.background='#193b30'; recLamp.style.boxShadow='0 0 0 2px #0b1a14 inset'; recBtn.textContent='‚óè Record';
  }
});
dlBtn.addEventListener('click', (e)=>{
  if(!dlBtn._url){ e.preventDefault(); return; }
  const a = document.createElement('a'); a.href = dlBtn._url; a.download = 'UltraMix.webm';
  document.body.appendChild(a); a.click(); a.remove();
});

/* ===== Animation loop (playheads + meters) ===== */
function analyserToMeter(deck){
  if(deck.analyser && deck.meterFill){
    const lv = analyserLevel(deck.analyser);
    deck.meterFill.style.height = Math.round(lv*100)+'%';
  }
}
function tick(){
  if(ctx){
    [deckA, deckB].forEach(d=>{
      if(d.isPlaying){
        const newOff = ctx.currentTime - d.startTime;
        if(newOff >= d.buffer.duration){
          d.isPlaying = false; d.offset = 0; d.seekEl.value = 0; prepareSource(d);
        }
      }
      analyserToMeter(d);
    });
    drawHeads();
  }
  requestAnimationFrame(tick);
}
tick();

/* ===== Start hidden, pulse appear button ===== */
panel.hidden = true;
appearBtn.classList.add('pulse');
</script>
</body>
</html><!-- ============== PSYFORGE PSYTRANCE COVER ============== -->
<style>
  #psyforgeCover{
    position:fixed; inset:0; z-index:999999; display:grid; place-items:center;
    overflow:hidden; font-family:"Segoe UI",system-ui,sans-serif; color:#eaffef;
    opacity:1; transition:opacity .45s ease; pointer-events:auto;
  }
  #psyforgeCover.hidden{ opacity:0; pointer-events:none; }

  /* Background kaleidoscope canvas */
  #coverKale{
    position:absolute; inset:0; width:100%; height:100%; display:block; background:#000;
  }

  /* Card with title & text */
  #psyforgeCover .card{
    position:relative; z-index:1; text-align:center;
    padding:26px 32px; border-radius:24px; max-width:min(720px,92vw);
    background:linear-gradient(180deg, rgba(10,18,26,.82), rgba(10,16,24,.68));
    border:1px solid rgba(124,246,255,.4);
    box-shadow:0 0 36px rgba(124,246,255,.28), inset 0 0 22px rgba(0,0,0,.4);
    backdrop-filter:blur(8px);
  }
  .logo{
    font-weight:900; letter-spacing:.06em; text-transform:uppercase;
    font-size:clamp(36px,7.5vw,78px); line-height:1.02; margin:0 0 8px;
    background:linear-gradient(90deg,#7cf6ff,#35ff8a,#ffe66d,#ff6db4,#7cf6ff);
    -webkit-background-clip:text; background-clip:text; color:transparent;
    text-shadow:0 0 18px rgba(124,246,255,.5), 0 0 36px rgba(53,255,138,.35);
    animation:hueshift 12s linear infinite;
  }
  @keyframes hueshift{to{filter:hue-rotate(360deg)}}
  .tag{font-weight:800; opacity:.95; margin-bottom:12px}
  .poem{font-size:clamp(14px,2.6vw,18px); line-height:1.45; color:#d8ffee; margin:10px 0 16px}
  .hint{font-weight:900; letter-spacing:.08em; color:#b9ffd8; text-shadow:0 0 12px #35ff8a66}

  /* Enter button */
  .enterBtn{
    margin-top:14px; all:unset; cursor:pointer; padding:12px 18px; border-radius:14px;
    font-weight:900; font-size:15px; color:#06130d;
    background:linear-gradient(180deg,#b9ffd8,#54f7a9);
    border:1px solid rgba(53,255,138,.6);
    box-shadow:0 0 20px #35ff8a88, inset 0 0 0 1px rgba(0,0,0,.22);
  }
  .enterBtn:hover{ filter:brightness(1.06) }

  /* Subtle reappear button */
  #coverReappear{
    position:fixed; right:12px; bottom:14px; z-index:999998;
    display:none; padding:6px 10px; border-radius:10px; cursor:pointer;
    font-weight:700; font-size:11px; color:#06130d;
    background:linear-gradient(180deg,#a9e6ff,#3393ff);
    border:1px solid rgba(124,246,255,.5);
    box-shadow:0 0 12px #7cf6ff66;
    opacity:.8; transition:opacity .25s ease;
  }
  #coverReappear:hover{ opacity:1 }
</style>

<div id="psyforgeCover" role="dialog" aria-label="PsyForge Cover">
  <canvas id="coverKale"></canvas>
  <div class="card">
    <div class="logo">PSYFORGE</div>
    <div class="tag">The Psychedelic Visual Mixer</div>
    <div class="poem">
      Twist sound into light, bend colors into rhythm, and watch imagination dance.<br/>
      A playground of <strong>kaleidoscopes, mirrors, and motion</strong> ‚Äî made for dreamers,
      artists, and kids in need.
    </div>
    <div class="hint">Press ENTER to begin</div>
    <button class="enterBtn" id="coverEnter">ENTER PSYFORGE</button>
  </div>
</div>

<button id="coverReappear" title="Show Cover">üí´ Reappear</button>

<script>
(() => {
  const cover  = document.getElementById('psyforgeCover');
  const enter  = document.getElementById('coverEnter');
  const reBtn  = document.getElementById('coverReappear');
  const kale   = document.getElementById('coverKale');
  const ctx = kale.getContext('2d');

  let visible = true;
  function showCover(){
    if(visible) return;
    visible = true;
    cover.classList.remove('hidden');
    cover.setAttribute('aria-hidden','false');
    reBtn.style.display = 'none';
  }
  function hideCover(){
    if(!visible) return;
    visible = false;
    cover.classList.add('hidden');
    cover.setAttribute('aria-hidden','true');
    setTimeout(()=>{ if(!visible) reBtn.style.display='inline-block'; }, 300);
  }

  enter.addEventListener('click', hideCover);
  reBtn.addEventListener('click', showCover);

  window.PsyforgeCover = { show: showCover, hide: hideCover };

  // Canvas plasma / psytrance loop
  function resize(){
    kale.width = window.innerWidth;
    kale.height = window.innerHeight;
  }
  window.addEventListener('resize', resize); resize();

  let t = 0;
  function loop(){
    const w = kale.width, h = kale.height;
    const img = ctx.createImageData(w,h);
    const d = img.data;
    for(let y=0;y<h;y++){
      for(let x=0;x<w;x++){
        const i=(y*w+x)*4;
        const v = Math.sin(x/45 + t/20) + Math.cos(y/35 - t/30) + Math.sin((x+y)/60 + t/15);
        const hue = (v*120 + t*4) % 360;
        const sat = 100;
        const light = 50 + 25*Math.sin((x+y+t)/80);
        const [r,g,b] = hslToRgb(hue/360, sat/100, light/100);
        d[i]=r; d[i+1]=g; d[i+2]=b; d[i+3]=255;
      }
    }
    ctx.putImageData(img,0,0);
    t++;
    requestAnimationFrame(loop);
  }
  loop();

  // HSL ‚Üí RGB helper
  function hslToRgb(h,s,l){
    let r,g,b;
    if(s==0){r=g=b=l;}
    else{
      const hue2rgb=(p,q,t)=>{
        if(t<0)t+=1;if(t>1)t-=1;
        if(t<1/6)return p+(q-p)*6*t;
        if(t<1/2)return q;
        if(t<2/3)return p+(q-p)*(2/3-t)*6;
        return p;
      };
      const q=l<.5?l*(1+s):l+s-l*s;
      const p=2*l-q;
      r=hue2rgb(p,q,h+1/3);
      g=hue2rgb(p,q,h);
      b=hue2rgb(p,q,h-1/3);
    }
    return [r*255,g*255,b*255];
  }
})();
</script>
<!-- ================= /PSYFORGE COVER =================== --><!-- === DONATE PANEL WITH BOTTOM REAPPEAR ================ -->
<style>
  .donate-wrap{
    position:fixed;top:20px;right:20px;z-index:1000;
    display:flex;flex-direction:column;align-items:flex-end;gap:10px;
    font-family:'Segoe UI',system-ui,sans-serif;
  }
  .donate-card{
    max-width:min(500px,95vw);
    border-radius:20px;padding:18px 20px;
    background:linear-gradient(180deg,rgba(20,28,36,.92),rgba(12,18,28,.85));
    border:2px solid #35ff8a;
    box-shadow:0 0 30px #35ff8a88,0 0 60px #7cf6ff55;
    color:#eaffef;text-align:left;
    animation:floaty 6s ease-in-out infinite;
  }
  @keyframes floaty{0%,100%{transform:translateY(0)}50%{transform:translateY(-4px)}}

  .donate-title{
    font-size:20px;font-weight:900;margin-bottom:10px;
    text-shadow:0 0 12px #7cf6ff,0 0 24px #35ff8a;
  }
  .donate-line{font-size:15px;margin-bottom:14px;line-height:1.4}
  .donate-line em{color:#ffe66d;font-style:normal;font-weight:700}

  .donate-btns{display:flex;flex-wrap:wrap;gap:10px}
  .don-btn{
    all:unset;cursor:pointer;padding:10px 18px;border-radius:14px;font-weight:800;
    font-size:15px;display:inline-flex;align-items:center;gap:8px;
    background:linear-gradient(180deg,#b9ffd8,#54f7a9);color:#0a1f14;
    box-shadow:0 0 20px #35ff8a88,inset 0 0 0 2px rgba(0,0,0,.2);
  }
  .don-btn--blue{
    background:linear-gradient(180deg,#a9e6ff,#3393ff);color:#fff;
    box-shadow:0 0 20px #7cf6ff88,inset 0 0 0 2px rgba(0,0,0,.2);
  }
  .don-row{display:flex;justify-content:flex-end;margin-top:10px}
  .don-mini{
    all:unset;cursor:pointer;padding:6px 12px;border-radius:10px;font-size:13px;
    font-weight:700;color:#fff;
    background:linear-gradient(180deg,#ff8ba7,#ff3355);
    box-shadow:0 0 12px #ff6db488;
  }

  /* Reappear button fixed at bottom center */
  #donReappear{
    display:none;position:fixed;bottom:20px;left:50%;transform:translateX(-50%);
    cursor:pointer;padding:12px 18px;border-radius:16px;font-weight:800;
    background:linear-gradient(180deg,#ffe66d,#ff9e33);
    box-shadow:0 0 20px #ffae5588;
    color:#1a1205;font-size:15px;z-index:1001;
    animation:pulse 2s infinite;
  }
  @keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.1)}}
</style>

<div class="donate-wrap">
  <div class="donate-card" id="donCard">
    <div class="donate-title">‚ú® We Help Kids Create ‚ú®</div>
    <div class="donate-line">
      Together we turn <em>what if</em> into <em>we did</em> ‚Äî
      giving kids in need the tools to <em>draw, dream, and discover</em>.
      Your gift fuels art, music, and safe spaces for their imagination. üåà
    </div>
    <div class="donate-btns">
      <a class="don-btn" href="https://cash.app/$lightwell333" target="_blank">üíö CashApp</a>
      <a class="don-btn don-btn--blue" href="https://paypal.me/lightwell333" target="_blank">üíô PayPal</a>
    </div>
    <div class="don-row">
      <button class="don-mini" id="donClose">Close</button>
    </div>
  </div>
</div>

<button id="donReappear">üí´ Reappear Donate</button>

<script>
(()=> {
  const card=document.getElementById('donCard');
  const close=document.getElementById('donClose');
  const reappear=document.getElementById('donReappear');

  close.addEventListener('click', ()=>{
    card.style.display='none';
    reappear.style.display='inline-block';
  });
  reappear.addEventListener('click', ()=>{
    card.style.display='block';
    reappear.style.display='none';
  });
})();
</script>
<!-- === /DONATE PANEL ================================== --><!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Embed ‚Äî CodePen qEbWNoE</title>
<style>
  html,body{height:100%;margin:0}
  /* Full-viewport embed */
  .wrap{min-height:100%;display:grid;place-items:stretch;background:#050a0d}
  .codepen, iframe{width:100%;height:100%;border:0;display:block}
  /* Optional: a tiny top bar you can remove */
  .bar{position:fixed;left:0;top:0;right:0;z-index:2;display:flex;gap:8px;
       padding:8px 10px;font:600 12px/1.2 system-ui,Segoe UI,Roboto,Arial;
       color:#eaffef;background:linear-gradient(180deg,#0a1117,#0b1614);
       border-bottom:1px solid #163328;box-shadow:0 4px 20px #0006}
  .bar a{color:#35ff8a;text-decoration:none}
</style>
</head>
<body>
<div class="bar">
  <span>Embedded CodePen</span>
  <span>‚Ä¢</span>
  <a href="https://codepen.io/Jeremy-Sanders-the-animator/pen/qEbWNoE" target="_blank" rel="noopener">Open original</a>
</div>

<div class="wrap" style="padding-top:32px">
  <!-- Official CodePen embed (JS replaces this with an iframe) -->
  <p class="codepen"
     data-height="100%"
     data-default-tab="result"
     data-user="Jeremy-Sanders-the-animator"
     data-slug-hash="qEbWNoE"
     data-theme-id="dark"
     style="height:100%">
    <span>
      See the Pen <a href="https://codepen.io/Jeremy-Sanders-the-animator/pen/qEbWNoE">
      qEbWNoE</a> by Jeremy Sanders
      (<a href="https://codepen.io/Jeremy-Sanders-the-animator">@Jeremy-Sanders-the-animator</a>)
      on <a href="https://codepen.io">CodePen</a>.
    </span>
  </p>
  <script async src="https://cpwebassets.codepen.io/assets/embed/ei.js"></script>

  <!-- No-JS fallback: direct iframe -->
  <noscript>
    <iframe
      src="https://codepen.io/Jeremy-Sanders-the-animator/embed/qEbWNoE?default-tab=result&theme-id=dark"
      loading="lazy" allowfullscreen></iframe>
  </noscript>
</div>
</body>
</html>
